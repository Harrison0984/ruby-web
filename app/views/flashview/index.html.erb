<% content_for :menus do %>
    <li data-tag="idx">
        <%= link_to '幸运九宫格', controller: 'main', action: 'index' %>
    </li>
    <li data-tag="kj">
        <%= link_to '历史开奖号码', controller: 'mainhistory', action: 'index' %>
    </li>
    <li  data-tag="zhl">
        <%= link_to '单选盘', controller: 'singlegame', action: 'index' %>
    </li>
    <li  data-tag="dshl">
        <%= link_to '组合盘', controller: 'combinationgame', action: 'index' %>
    </li>
    <li   data-tag="sxpl">
        <%= link_to '双面盘', controller: 'doublegame', action: 'index' %>
    </li>
    <li class=hover data-tag="kjs">
        <%= link_to '九宫格开奖直播', controller: 'flashview', action: 'index' %>
    </li>
    <li    data-tag="mfc">
        <%= link_to '游戏记录', controller: 'traceresult', action: 'index' %>
    </li>
<% end %>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.js"></script>
<script  language="javascript" type="text/javascript" src="/timer.jquery.js"> </script> 
<script type="text/javascript">
function thisMovie(movieName) {
    if (window.document[movieName]) {
        return window.document[movieName];
    } else if (navigator.appName.indexOf("Microsoft Internet") == -1) {
        if (document.embeds && document.embeds[movieName]) return document.embeds[movieName];
    } else {
        return document.getElementById(movieName);
    }
}

    function nowNum(){
        thisMovie('luck').nowNum(2015071688,"3,3,3,4,5,6,7,8,8");
    }
    function nextNum(){
        thisMovie('luck').nextNum(2015071689);
    }
    function nextTime(){
        thisMovie('luck').nextTime("14:25:26");
    }
    function countTime(){
        thisMovie('luck').countTime(10)
    }
    function hisNum(){
        thisMovie('luck').hisNum(2015071602,"2,2,2,4,5,6,7,8,8",1);
        thisMovie('luck').hisNum(2015071601,"1,1,1,4,5,6,7,8,8",2);
    }
</script>


<script type="text/javascript">


$(document).ready(function(){
  $("#refresh").click(function(){
    $.get("/jsondata", onGotJson);
  });
});

(function() {
$('#div-id').timer({
    duration: '3s',
    callback: function() {
        alert('Why, Hello there');  //you could have a ajax call here instead
    },
    repeat: true //repeatedly calls the callback you specify
});
}());

function onGotJson(data, status)
{
      //alert("数据：" + data + "\n状态：" + status);
      var obj = jQuery.parseJSON(data);  
      var a = Date.parse(obj.nexttime) - Date.parse(obj.servertime);
      thisMovie('luck').countTime(a/1000);
      var nextDate = new Date(obj.nexttime);
      thisMovie('luck').nextTime(obj.nexttime.substr(obj.nexttime.indexOf(" ")));
      thisMovie('luck').nextNum(obj.nextno);
      //alert(obj.history.length);
      for(var i=0; i < 3; i++)
      {
          if (i==0) 
          {
            thisMovie('luck') .nowNum(obj.history[i].no, obj.history[i].num);
          }
          else
          {
            thisMovie('luck').hisNum(obj.history[i].no, obj.history[i].num, 3 - i);
          }
      }
      
      //alert(obj.servertime);
}




  $('#refresh').timer({
  seconds: 3,
  duration: '3s',
  callback: function() {
    alert('Time up!');
  },
  repeat:true
});


</script>

</head>



<body>
<div id="div-id"></div>
<div id="avatar_priview" style="position:absolute;left:420px;"></div>

<div style="height:630px;">

<p>
  <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553520000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" width="980" height="630">
    <param name="movie" value=<%= image_url("index.swf") %>>
    <param name="quality" value="high">
    <param name="bgcolor" value="#FFFFFF">
    
<embed width="980" height="630" align="middle"  pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" name="luck" bgcolor="#ffffff" quality="best" menu="false" loop="false" src=<%= image_url("index.swf") %> id="luck" allownetworking="all">
  </object>      
</p>

<br>
  <input type="button" value="刷新" id="refresh" />
</p>


<p id="resultp"></p>
</div>
